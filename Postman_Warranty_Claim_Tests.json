{
  "info": {
    "name": "EV Warranty Claim Management - Test Collection",
    "description": "Collection ƒë·ªÉ test ƒë·∫ßy ƒë·ªß flow ƒëƒÉng k√Ω v√† x·ª≠ l√Ω b·∫£o h√†nh xe ƒëi·ªán",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "1. Authentication",
      "item": [
        {
          "name": "Login - SC Staff (sc_staff1)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Login successful\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    var token = jsonData.token || jsonData.accessToken;",
                  "    ",
                  "    pm.test(\"Token exists\", function () {",
                  "        pm.expect(token).to.be.a('string');",
                  "        pm.expect(token).to.not.be.empty;",
                  "    });",
                  "    ",
                  "    pm.collectionVariables.set(\"access_token\", token);",
                  "    pm.collectionVariables.set(\"current_user\", jsonData.username);",
                  "    pm.collectionVariables.set(\"current_role\", jsonData.role);",
                  "    console.log(\"‚úÖ SC Staff Token saved: \" + token.substring(0, 20) + \"...\");",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"sc_staff1\",\n  \"password\": \"123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/login",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "login"]
            }
          },
          "response": []
        },
        {
          "name": "Login - SC Technician (tech1)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Login successful\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    var token = jsonData.token || jsonData.accessToken;",
                  "    ",
                  "    pm.test(\"Token exists\", function () {",
                  "        pm.expect(token).to.be.a('string');",
                  "        pm.expect(token).to.not.be.empty;",
                  "    });",
                  "    ",
                  "    pm.collectionVariables.set(\"technician_token\", token);",
                  "    pm.collectionVariables.set(\"technician_user\", jsonData.username);",
                  "    pm.collectionVariables.set(\"technician_role\", jsonData.role);",
                  "    pm.collectionVariables.set(\"technician_id\", jsonData.userId || jsonData.id);",
                  "    console.log(\"‚úÖ Technician Token saved: \" + token.substring(0, 20) + \"...\");",
                  "    console.log(\"‚úÖ Technician User: \" + jsonData.username + \", Role: \" + jsonData.role);",
                  "    console.log(\"‚úÖ Technician ID: \" + (jsonData.userId || jsonData.id));",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"tech1\",\n  \"password\": \"123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/login",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "login"]
            }
          },
          "response": []
        },
        {
          "name": "Login - EVM Staff (evm_staff1)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Login successful\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    var token = jsonData.token || jsonData.accessToken;",
                  "    ",
                  "    pm.test(\"Token exists\", function () {",
                  "        pm.expect(token).to.be.a('string');",
                  "        pm.expect(token).to.not.be.empty;",
                  "    });",
                  "    ",
                  "    pm.collectionVariables.set(\"evm_token\", token);",
                  "    pm.collectionVariables.set(\"evm_user\", jsonData.username);",
                  "    pm.collectionVariables.set(\"evm_role\", jsonData.role);",
                  "    console.log(\"‚úÖ EVM Token saved: \" + token.substring(0, 20) + \"...\");",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"evm_staff1\",\n  \"password\": \"123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/login",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "login"]
            }
          },
          "response": []
        },
        {
          "name": "Login - Admin (admin_user)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Login successful\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    var token = jsonData.token || jsonData.accessToken;",
                  "    ",
                  "    pm.test(\"Token exists\", function () {",
                  "        pm.expect(token).to.be.a('string');",
                  "        pm.expect(token).to.not.be.empty;",
                  "    });",
                  "    ",
                  "    pm.collectionVariables.set(\"admin_token\", token);",
                  "    pm.collectionVariables.set(\"admin_user\", jsonData.username);",
                  "    pm.collectionVariables.set(\"admin_role\", jsonData.role);",
                  "    console.log(\"‚úÖ Admin Token saved: \" + token.substring(0, 20) + \"...\");",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"admin_user\",\n  \"password\": \"123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/login",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "login"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "2. Flow 1 - Intake-first (T·∫°o claim ho√†n ch·ªânh)",
      "item": [
        {
          "name": "2.1 T·∫°o claim ho√†n ch·ªânh qua intake",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"customerName\": \"Nguy·ªÖn VƒÉn A\",\n  \"customerPhone\": \"0901234567\",\n  \"customerEmail\": \"nguyenvana@example.com\",\n  \"customerAddress\": \"123 ƒê∆∞·ªùng ABC, Qu·∫≠n 1, TP.HCM\",\n  \"vin\": \"1HGBH41JXMN109186\",\n  \"mileageKm\": 15000,\n  \"claimTitle\": \"Pin xe s·ª•t ƒëi·ªán b·∫•t th∆∞·ªùng\",\n  \"reportedFailure\": \"Kh√°ch h√†ng ph·∫£n √°nh xe b·ªã s·ª•t ƒëi·ªán nhanh, ch·ªâ ch·∫°y ƒë∆∞·ª£c 150km thay v√¨ 350km nh∆∞ ban ƒë·∫ßu. Pin hi·ªÉn th·ªã c·∫£nh b√°o nhi·ªát ƒë·ªô cao.\",\n  \"appointmentDate\": \"2025-10-20T09:00:00\",\n  \"customerConsent\": true,\n  \"assignedTechnicianId\": 5\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/intake",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "intake"]
            }
          },
          "response": []
        },
        {
          "name": "2.2 T·∫°o claim - Pin b·ªã l·ªói BMS",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"customerName\": \"Tr·∫ßn Th·ªã B\",\n  \"customerPhone\": \"0912345678\",\n  \"customerEmail\": \"tranthib@example.com\",\n  \"customerAddress\": \"456 ƒê∆∞·ªùng XYZ, Qu·∫≠n 3, TP.HCM\",\n  \"vin\": \"5YJSA1E14HF999999\",\n  \"mileageKm\": 8500,\n  \"claimTitle\": \"L·ªói h·ªá th·ªëng BMS - kh√¥ng s·∫°c ƒë∆∞·ª£c\",\n  \"reportedFailure\": \"Xe kh√¥ng th·ªÉ s·∫°c pin. M√†n h√¨nh hi·ªÉn th·ªã l·ªói BMS error code E-501. Khi c·∫Øm s·∫°c kh√¥ng c√≥ ph·∫£n ·ª©ng g√¨.\",\n  \"appointmentDate\": \"2025-10-21T14:00:00\",\n  \"customerConsent\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/intake",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "intake"]
            }
          },
          "response": []
        },
        {
          "name": "2.3 Submit claim to EVM",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Submit to EVM success\", function () {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "var data = pm.response.json();",
                  "pm.collectionVariables.set('evm_pending_claim_id', data.id);",
                  "pm.test(\"Status is PENDING_EVM_APPROVAL\", function () {",
                  "  pm.expect(data.status).to.eql('PENDING_EVM_APPROVAL');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"claimId\": 1,\n  \"submissionNotes\": \"Claim ƒë√£ ƒë∆∞·ª£c ki·ªÉm tra ƒë·∫ßy ƒë·ªß, s·∫µn s√†ng g·ª≠i EVM ph√™ duy·ªát\",\n  \"forceSubmit\": false\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/submit",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "submit"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "3. Flow 2 - Collaborative (Draft + Diagnostic)",
      "item": [
        {
          "name": "3.1 T·∫°o draft claim",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Draft claim created successfully\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    var claimId = jsonData.id;",
                  "    ",
                  "    pm.test(\"Claim ID exists\", function () {",
                  "        pm.expect(claimId).to.be.a('number');",
                  "        pm.expect(claimId).to.be.greaterThan(0);",
                  "    });",
                  "    ",
                  "    pm.collectionVariables.set(\"draft_claim_id\", claimId);",
                  "    console.log(\"‚úÖ Draft Claim ID saved: \" + claimId);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"customerName\": \"L√™ VƒÉn C\",\n  \"customerPhone\": \"0923456789\",\n  \"customerEmail\": \"levanc@example.com\",\n  \"customerAddress\": \"789 ƒê∆∞·ªùng DEF, Qu·∫≠n 7, TP.HCM\",\n  \"vin\": \"WAUZZZ4G7DN123456\",\n  \"mileageKm\": 22000,\n  \"claimTitle\": \"Motor ƒëi·ªán ph√°t ra ti·∫øng k√™u b·∫•t th∆∞·ªùng\",\n  \"reportedFailure\": \"Kh√°ch h√†ng ph·∫£n √°nh khi tƒÉng t·ªëc motor ph√°t ra ti·∫øng k√™u l·∫°, rung nh·∫π. C·∫ßn technician ki·ªÉm tra k·ªπ.\",\n  \"appointmentDate\": \"2025-10-22T10:30:00\",\n  \"customerConsent\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/draft",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "draft"]
            }
          },
          "response": []
        },
        {
          "name": "3.2 Technician c·∫≠p nh·∫≠t diagnostic",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{technician_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"diagnosticSummary\": \"Ph√°t hi·ªán bearing motor b·ªã m√≤n, c·∫ßn thay th·∫ø. Ki·ªÉm tra c√°c cell pin ƒë·ªÅu ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng.\",\n  \"diagnosticData\": \"{\\\"error_codes\\\": [\\\"M-301\\\", \\\"M-302\\\"], \\\"motor_temp\\\": 75, \\\"vibration_level\\\": \\\"high\\\"}\",\n  \"testResults\": \"Motor current: 180A (normal: 150A), Temperature: 75¬∞C, Vibration: 8.5mm/s (normal: <5mm/s)\",\n  \"repairNotes\": \"ƒê√£ th√°o motor ki·ªÉm tra. Bearing ph√≠a tr∆∞·ªõc b·ªã m√≤n nghi√™m tr·ªçng. ƒê·ªÅ xu·∫•t thay bearing v√† ki·ªÉm tra l·∫°i to√†n b·ªô h·ªá th·ªëng truy·ªÅn ƒë·ªông.\",\n  \"laborHours\": 4.5,\n  \"partsUsed\": [\n    {\n      \"partId\": 101,\n      \"quantity\": 2,\n      \"notes\": \"Motor bearing set - front and rear\"\n    },\n    {\n      \"partId\": 102,\n      \"quantity\": 1,\n      \"notes\": \"Motor seal gasket\"\n    }\n  ],\n  \"attachmentPaths\": [\n    \"/uploads/claims/3/motor_inspection_photo1.jpg\",\n    \"/uploads/claims/3/diagnostic_report.pdf\"\n  ],\n  \"initialDiagnosis\": \"Motor bearing failure causing abnormal noise and vibration\",\n  \"readyForSubmission\": false\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/{{draft_claim_id}}/diagnostic",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "{{draft_claim_id}}", "diagnostic"]
            }
          },
          "response": []
        },
        {
          "name": "3.3 ƒê√°nh d·∫•u s·∫µn s√†ng submit",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/claims/{{draft_claim_id}}/ready",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "{{draft_claim_id}}", "ready"]
            }
          },
          "response": []
        },
        {
          "name": "3.4 Validate claim tr∆∞·ªõc khi submit",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/claims/{{draft_claim_id}}/validate",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "{{draft_claim_id}}", "validate"]
            }
          },
          "response": []
        },
        {
          "name": "3.5 Submit claim to EVM",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Submit to EVM success\", function () {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "var data = pm.response.json();",
                  "pm.collectionVariables.set('evm_pending_claim_id', data.id);",
                  "pm.test(\"Status is PENDING_EVM_APPROVAL\", function () {",
                  "  pm.expect(data.status).to.eql('PENDING_EVM_APPROVAL');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"claimId\": {{draft_claim_id}},\n  \"submissionNotes\": \"ƒê√£ ho√†n th√†nh diagnostic. Motor bearing c·∫ßn thay th·∫ø theo b·∫£o h√†nh. T·∫•t c·∫£ t√†i li·ªáu ƒë√≠nh k√®m ƒë·∫ßy ƒë·ªß.\",\n  \"forceSubmit\": false\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/submit",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "submit"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "4. Query & View Claims",
      "item": [
        {
          "name": "4.1 Xem chi ti·∫øt claim",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/claims/{{claim_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "{{claim_id}}"]
            }
          },
          "response": []
        },
        {
          "name": "4.2 L·∫•y claims c·ªßa technician",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{technician_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/claims/technician/4",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "technician", "4"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "5. Flow 3 - SC Staff Assign Technician (Test Assignment)",
      "item": [
        {
          "name": "5.1 Login Technician th·ª© 2 (tech2)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Login successful\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    var token = jsonData.token || jsonData.accessToken;",
                  "    ",
                  "    pm.test(\"Token exists\", function () {",
                  "        pm.expect(token).to.be.a('string');",
                  "        pm.expect(token).to.not.be.empty;",
                  "    });",
                  "    ",
                  "    pm.collectionVariables.set(\"technician2_token\", token);",
                  "    pm.collectionVariables.set(\"technician2_user\", jsonData.username);",
                  "    pm.collectionVariables.set(\"technician2_id\", jsonData.userId || jsonData.id);",
                  "    console.log(\"‚úÖ Technician 2 Token saved: \" + token.substring(0, 20) + \"...\");",
                  "    console.log(\"‚úÖ Technician 2 User: \" + jsonData.username);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"tech2\",\n  \"password\": \"123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/login",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "login"]
            }
          },
          "response": []
        },
        {
          "name": "5.3 SC Staff t·∫°o claim v√† assign technician c·ª• th·ªÉ",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Claim with assigned technician created successfully\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    var claimId = jsonData.id;",
                  "    ",
                  "    pm.test(\"Claim ID exists\", function () {",
                  "        pm.expect(claimId).to.be.a('number');",
                  "        pm.expect(claimId).to.be.greaterThan(0);",
                  "    });",
                  "    ",
                  "    pm.test(\"Technician is assigned\", function () {",
                  "        pm.expect(jsonData.assignedTechnician).to.not.be.null;",
                  "        if (jsonData.assignedTechnician) {",
                  "            pm.expect(jsonData.assignedTechnician.username).to.eql('tech1');",
                  "        }",
                  "    });",
                  "",
                  "    // Debug: Log the assigned technician info",
                  "    if (jsonData.assignedTechnician) {",
                  "        console.log(\"üîç Assigned Technician Debug:\");",
                  "        console.log(\"  - ID: \" + jsonData.assignedTechnician.id);",
                  "        console.log(\"  - Username: \" + jsonData.assignedTechnician.username);",
                  "        console.log(\"  - Full Name: \" + jsonData.assignedTechnician.fullName);",
                  "    } else {",
                  "        console.log(\"‚ö†Ô∏è No technician assigned to this claim\");",
                  "    }",
                  "    ",
                  "    pm.collectionVariables.set(\"assigned_claim_id\", claimId);",
                  "    if (jsonData.assignedTechnician) {",
                  "        pm.collectionVariables.set(\"assigned_technician_id\", jsonData.assignedTechnician.id);",
                  "        console.log(\"‚úÖ Assigned to: \" + jsonData.assignedTechnician.username);",
                  "        console.log(\"‚úÖ Assigned Technician ID: \" + jsonData.assignedTechnician.id);",
                  "    } else {",
                  "        console.log(\"‚ö†Ô∏è No technician assigned to this claim\");",
                  "    }",
                  "    console.log(\"‚úÖ Assigned Claim ID saved: \" + claimId);",
                  "}"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "// Get technician ID from login response (assuming it's stored)",
                  "// For testing, we'll use a known technician from data.sql",
                  "// But we need to get the actual ID of sc_technician_user",
                  "console.log('Setting up assigned technician test...');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"customerName\": \"V√µ Th·ªã D\",\n  \"customerPhone\": \"0934567890\",\n  \"customerEmail\": \"vothid@example.com\",\n  \"customerAddress\": \"456 ƒê∆∞·ªùng GHI, Qu·∫≠n 2, TP.HCM\",\n  \"vin\": \"1HGBH41JXMN109999\",\n  \"mileageKm\": 18500,\n  \"claimTitle\": \"H·ªá th·ªëng s·∫°c kh√¥ng ho·∫°t ƒë·ªông\",\n  \"reportedFailure\": \"Kh√°ch h√†ng ph·∫£n √°nh kh√¥ng th·ªÉ s·∫°c pin t·∫°i nh√†. Khi c·∫Øm s·∫°c AC kh√¥ng c√≥ ph·∫£n ·ª©ng, ƒë√®n b√°o kh√¥ng s√°ng.\",\n  \"appointmentDate\": \"2025-10-23T15:00:00\",\n  \"customerConsent\": true,\n  \"assignedTechnicianId\": 4\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/draft",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "draft"]
            }
          },
          "response": []
        },
        {
          "name": "5.4 Technician ƒë∆∞·ª£c assign c·∫≠p nh·∫≠t diagnostic - SUCCESS",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Technician diagnostic update successful\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    console.log(\"‚úÖ Diagnostic updated successfully by technician\");",
                  "    console.log(\"‚úÖ Claim ID: \" + jsonData.id);",
                  "    console.log(\"‚úÖ Assigned Technician: \" + jsonData.assignedTechnician.username);",
                  "} else {",
                  "    console.log(\"‚ùå Error: \" + pm.response.status + \" - \" + pm.response.text());",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{technician_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"diagnosticSummary\": \"Ki·ªÉm tra h·ªá th·ªëng s·∫°c AC. Ph√°t hi·ªán l·ªói ·ªü relay s·∫°c ch√≠nh. C·∫ßn thay th·∫ø module ƒëi·ªÅu khi·ªÉn s·∫°c.\",\n  \"diagnosticData\": \"{\\\"error_codes\\\": [\\\"CHG-401\\\", \\\"CHG-402\\\"], \\\"charging_current\\\": 0, \\\"relay_status\\\": \\\"failed\\\"}\",\n  \"testResults\": \"AC Input: 220V (OK), Relay Test: FAIL, Charging Current: 0A (should be 16A), Temperature: Normal\",\n  \"repairNotes\": \"ƒê√£ ki·ªÉm tra to√†n b·ªô h·ªá th·ªëng s·∫°c. Relay ch√≠nh b·ªã h·ªèng, kh√¥ng ƒë√≥ng m·∫°ch ƒë∆∞·ª£c. C·∫ßn thay relay v√† ki·ªÉm tra l·∫°i module ƒëi·ªÅu khi·ªÉn.\",\n  \"laborHours\": 3.0,\n  \"partsUsed\": [\n    {\n      \"partId\": 201,\n      \"quantity\": 1,\n      \"notes\": \"Main charging relay\"\n    },\n    {\n      \"partId\": 202,\n      \"quantity\": 1,\n      \"notes\": \"Charging control module\"\n    }\n  ],\n  \"attachmentPaths\": [\n    \"/uploads/claims/assigned/charging_system_test.pdf\",\n    \"/uploads/claims/assigned/relay_failure_photo.jpg\"\n  ],\n  \"initialDiagnosis\": \"Charging system relay failure - requires replacement\",\n  \"readyForSubmission\": false\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/{{assigned_claim_id}}/diagnostic",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "{{assigned_claim_id}}", "diagnostic"]
            }
          },
          "response": []
        },
        {
          "name": "5.5 Technician KH√ÅC c·ªë c·∫≠p nh·∫≠t - FAIL (403 Expected)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Technician 2 should get 403 Forbidden\", function () {",
                  "    pm.response.to.have.status(403);",
                  "});",
                  "",
                  "if (pm.response.code === 403) {",
                  "    console.log(\"‚úÖ Expected 403 error received - Technician 2 cannot update claim assigned to another technician\");",
                  "} else {",
                  "    console.log(\"‚ùå Unexpected response: \" + pm.response.status + \" - \" + pm.response.text());",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{technician2_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"diagnosticSummary\": \"Technician kh√°c c·ªë c·∫≠p nh·∫≠t - test case n√†y ph·∫£i FAIL\",\n  \"repairNotes\": \"ƒê√¢y l√† test case ƒë·ªÉ verify r·∫±ng technician kh√¥ng ƒë∆∞·ª£c assign kh√¥ng th·ªÉ c·∫≠p nh·∫≠t claim\",\n  \"readyForSubmission\": false\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/{{assigned_claim_id}}/diagnostic",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "{{assigned_claim_id}}", "diagnostic"]
            }
          },
          "response": []
        },
        {
          "name": "5.6 SC Staff c√≥ th·ªÉ c·∫≠p nh·∫≠t b·∫•t k·ª≥ claim n√†o - SUCCESS",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"SC Staff diagnostic update successful\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    console.log(\"‚úÖ SC Staff updated diagnostic successfully\");",
                  "    console.log(\"‚úÖ Claim ID: \" + jsonData.id);",
                  "    console.log(\"‚úÖ Ready for submission: \" + jsonData.canSubmitToEvm);",
                  "} else {",
                  "    console.log(\"‚ùå Error: \" + pm.response.status + \" - \" + pm.response.text());",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"diagnosticSummary\": \"SC Staff review v√† b·ªï sung th√¥ng tin diagnostic. ƒê√£ x√°c nh·∫≠n c·∫ßn thay relay s·∫°c.\",\n  \"repairNotes\": \"SC Staff ƒë√£ review k·∫øt qu·∫£ diagnostic c·ªßa technician. X√°c nh·∫≠n c·∫ßn thay relay v√† c√≥ th·ªÉ submit claim.\",\n  \"readyForSubmission\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/{{assigned_claim_id}}/diagnostic",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "{{assigned_claim_id}}", "diagnostic"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "6. EVM Review & Decision",
      "item": [
        {
          "name": "6.1 Get pending claims for EVM",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{evm_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/evm/claims/pending",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "evm",
                "claims",
                "pending"
              ]
            }
          },
          "response": []
        },
        {
          "name": "6.2 Approve pending claim",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Claim approved successfully\", function () {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "var data = pm.response.json();",
                  "pm.collectionVariables.set('approved_claim_id', data.id);",
                  "pm.test(\"Status is EVM_APPROVED\", function () {",
                  "  pm.expect(data.status).to.eql('EVM_APPROVED');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{evm_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"warrantyCost\": 500.00,\n  \"approvalNotes\": \"Approved for parts replacement under warranty\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/evm/claims/{{evm_pending_claim_id}}/approve",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "evm",
                "claims",
                "{{evm_pending_claim_id}}",
                "approve"
              ]
            }
          },
          "response": []
        },
        {
          "name": "6.3 Reject pending claim",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{evm_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"rejectionReason\": \"Insufficient diagnostic evidence provided\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/evm/claims/{{evm_pending_claim_id}}/reject",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "evm",
                "claims",
                "{{evm_pending_claim_id}}",
                "reject"
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "7. Work Order Management (Sau khi claim ƒë∆∞·ª£c approve)",
      "item": [
        {
          "name": "7.1 T·∫°o Work Order t·ª´ approved claim",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Work Order created successfully\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    var workOrderId = jsonData.id;",
                  "    ",
                  "    pm.test(\"Work Order ID exists\", function () {",
                  "        pm.expect(workOrderId).to.be.a('number');",
                  "        pm.expect(workOrderId).to.be.greaterThan(0);",
                  "    });",
                  "    ",
                  "    pm.collectionVariables.set(\"work_order_id\", workOrderId);",
                  "    console.log(\"‚úÖ Work Order ID saved: \" + workOrderId);",
                  "    console.log(\"‚úÖ Work Order Status: \" + jsonData.status);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"claimId\": {{approved_claim_id}},\n  \"assignedTechnicianId\": 4,\n  \"estimatedDuration\": 4.5,\n  \"priority\": \"HIGH\",\n  \"workDescription\": \"Thay th·∫ø motor bearing v√† ki·ªÉm tra h·ªá th·ªëng truy·ªÅn ƒë·ªông\",\n  \"specialInstructions\": \"C·∫ßn ki·ªÉm tra k·ªπ c√°c cell pin sau khi s·ª≠a ch·ªØa motor\",\n  \"requiredParts\": [\n    {\n      \"partId\": 101,\n      \"quantity\": 2,\n      \"notes\": \"Motor bearing set - front and rear\"\n    },\n    {\n      \"partId\": 102,\n      \"quantity\": 1,\n      \"notes\": \"Motor seal gasket\"\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/work-orders/create",
              "host": ["{{base_url}}"],
              "path": ["api", "work-orders", "create"]
            }
          },
          "response": []
        },
        {
          "name": "7.2 Technician nh·∫≠n Work Order v√† b·∫Øt ƒë·∫ßu",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{technician_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"IN_PROGRESS\",\n  \"notes\": \"B·∫Øt ƒë·∫ßu c√¥ng vi·ªác s·ª≠a ch·ªØa. ƒê√£ ki·ªÉm tra xe v√† chu·∫©n b·ªã d·ª•ng c·ª•.\",\n  \"actualStartTime\": \"2025-10-24T08:00:00\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/work-orders/{{work_order_id}}/update",
              "host": ["{{base_url}}"],
              "path": ["api", "work-orders", "{{work_order_id}}", "update"]
            }
          },
          "response": []
        },
        {
          "name": "7.3 C·∫≠p nh·∫≠t ti·∫øn ƒë·ªô s·ª≠a ch·ªØa - 25%",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{technician_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"progressPercentage\": 25,\n  \"progressNotes\": \"ƒê√£ th√°o motor ra kh·ªèi xe. Bearing ph√≠a tr∆∞·ªõc b·ªã m√≤n nghi√™m tr·ªçng nh∆∞ d·ª± ƒëo√°n. Chu·∫©n b·ªã thay th·∫ø.\",\n  \"attachmentPaths\": [\n    \"/uploads/workorders/{{work_order_id}}/motor_removal_1.jpg\",\n    \"/uploads/workorders/{{work_order_id}}/bearing_damage_1.jpg\"\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/work-orders/{{work_order_id}}/update",
              "host": ["{{base_url}}"],
              "path": ["api", "work-orders", "{{work_order_id}}", "update"]
            }
          },
          "response": []
        },
        {
          "name": "7.4 C·∫≠p nh·∫≠t ti·∫øn ƒë·ªô s·ª≠a ch·ªØa - 50%",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{technician_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"progressPercentage\": 50,\n  \"progressNotes\": \"ƒê√£ thay th·∫ø bearing ph√≠a tr∆∞·ªõc v√† ph√≠a sau. Ki·ªÉm tra c√°c b·ªô ph·∫≠n kh√°c c·ªßa motor ƒë·ªÅu ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng.\",\n  \"attachmentPaths\": [\n    \"/uploads/workorders/{{work_order_id}}/bearing_replacement_1.jpg\",\n    \"/uploads/workorders/{{work_order_id}}/motor_inspection_1.jpg\"\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/work-orders/{{work_order_id}}/update",
              "host": ["{{base_url}}"],
              "path": ["api", "work-orders", "{{work_order_id}}", "update"]
            }
          },
          "response": []
        },
        {
          "name": "7.5 C·∫≠p nh·∫≠t ti·∫øn ƒë·ªô s·ª≠a ch·ªØa - 75%",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{technician_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"progressPercentage\": 75,\n  \"progressNotes\": \"ƒê√£ l·∫Øp motor tr·ªü l·∫°i xe. Ti·∫øn h√†nh test ch·∫°y th·ª≠. Motor ho·∫°t ƒë·ªông √™m, kh√¥ng c√≤n ti·∫øng k√™u b·∫•t th∆∞·ªùng.\",\n  \"attachmentPaths\": [\n    \"/uploads/workorders/{{work_order_id}}/motor_installation_1.jpg\",\n    \"/uploads/workorders/{{work_order_id}}/test_run_1.jpg\"\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/work-orders/{{work_order_id}}/update",
              "host": ["{{base_url}}"],
              "path": ["api", "work-orders", "{{work_order_id}}", "update"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "8. Quality Control & Testing",
      "item": [
        {
          "name": "8.1 C·∫≠p nh·∫≠t ti·∫øn ƒë·ªô s·ª≠a ch·ªØa - 90% (Ki·ªÉm tra ch·∫•t l∆∞·ª£ng)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{technician_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"progressPercentage\": 90,\n  \"progressNotes\": \"Ti·∫øn h√†nh ki·ªÉm tra ch·∫•t l∆∞·ª£ng to√†n di·ªán. Test ƒë∆∞·ªùng b·ªô 10km, ki·ªÉm tra t·∫•t c·∫£ h·ªá th·ªëng. K·∫øt qu·∫£: Motor ho·∫°t ƒë·ªông ho√†n h·∫£o, kh√¥ng c√≥ ti·∫øng k√™u hay rung ƒë·ªông b·∫•t th∆∞·ªùng.\",\n  \"attachmentPaths\": [\n    \"/uploads/workorders/{{work_order_id}}/quality_check_1.jpg\",\n    \"/uploads/workorders/{{work_order_id}}/road_test_1.jpg\",\n    \"/uploads/workorders/{{work_order_id}}/final_inspection_1.jpg\"\n  ],\n  \"qualityCheckResults\": {\n    \"motorNoise\": \"NORMAL\",\n    \"vibrationLevel\": \"NORMAL\",\n    \"powerOutput\": \"NORMAL\",\n    \"roadTestResult\": \"PASSED\",\n    \"overallQuality\": \"EXCELLENT\"\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/work-orders/{{work_order_id}}/update",
              "host": ["{{base_url}}"],
              "path": ["api", "work-orders", "{{work_order_id}}", "update"]
            }
          },
          "response": []
        },
        {
          "name": "8.2 SC Staff ki·ªÉm tra v√† x√°c nh·∫≠n ho√†n th√†nh",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"COMPLETED\",\n  \"completionNotes\": \"SC Staff ƒë√£ ki·ªÉm tra v√† x√°c nh·∫≠n c√¥ng vi·ªác ho√†n th√†nh. Ch·∫•t l∆∞·ª£ng s·ª≠a ch·ªØa ƒë·∫°t y√™u c·∫ßu. S·∫µn s√†ng b√†n giao cho kh√°ch h√†ng.\",\n  \"actualEndTime\": \"2025-10-24T12:30:00\",\n  \"actualLaborHours\": 4.5,\n  \"qualityApproval\": true,\n  \"approvalBy\": \"sc_staff_user\",\n  \"finalInspectionResults\": {\n    \"motorPerformance\": \"EXCELLENT\",\n    \"noiseLevel\": \"NORMAL\",\n    \"vibrationTest\": \"PASSED\",\n    \"roadTest\": \"PASSED\",\n    \"safetyCheck\": \"PASSED\"\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/work-orders/{{work_order_id}}/complete",
              "host": ["{{base_url}}"],
              "path": ["api", "work-orders", "{{work_order_id}}", "complete"]
            }
          },
          "response": []
        },
        {
          "name": "8.3 C·∫≠p nh·∫≠t claim status th√†nh COMPLETED",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"COMPLETED\",\n  \"completionNotes\": \"C√¥ng vi·ªác s·ª≠a ch·ªØa ƒë√£ ho√†n th√†nh th√†nh c√¥ng. Xe ƒë√£ s·∫µn s√†ng ƒë·ªÉ b√†n giao cho kh√°ch h√†ng.\",\n  \"actualRepairCost\": 450.00,\n  \"actualLaborHours\": 4.5\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/{{approved_claim_id}}/complete-repair",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "{{approved_claim_id}}", "complete-repair"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "9. Customer Notification & Vehicle Handover",
      "item": [
        {
          "name": "9.1 T·∫°o appointment ƒë·ªÉ kh√°ch h√†ng ƒë·∫øn l·∫•y xe",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"claimId\": {{approved_claim_id}},\n  \"appointmentType\": \"VEHICLE_PICKUP\",\n  \"appointmentDate\": \"2025-10-24T15:00:00\",\n  \"notes\": \"Xe ƒë√£ s·ª≠a ch·ªØa xong. Kh√°ch h√†ng ƒë·∫øn l·∫•y xe v√† thanh to√°n (n·∫øu c√≥ ph√°t sinh chi ph√≠).\",\n  \"customerNotification\": true,\n  \"notificationMessage\": \"Xe c·ªßa b·∫°n ƒë√£ s·ª≠a ch·ªØa xong v√† s·∫µn s√†ng ƒë·ªÉ l·∫•y. Vui l√≤ng ƒë·∫øn SC l√∫c 15:00 ng√†y 24/10/2025.\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/appointments/create",
              "host": ["{{base_url}}"],
              "path": ["api", "appointments", "create"]
            }
          },
          "response": []
        },
        {
          "name": "9.2 G·ª≠i th√¥ng b√°o cho kh√°ch h√†ng (SMS/Email) - COMMENTED OUT",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"claimId\": {{approved_claim_id}},\n  \"notificationType\": \"VEHICLE_READY\",\n  \"channels\": [\"SMS\", \"EMAIL\"],\n  \"message\": \"Xe c·ªßa b·∫°n ƒë√£ s·ª≠a ch·ªØa xong. Vui l√≤ng ƒë·∫øn SC l·∫•y xe l√∫c 15:00 ng√†y 24/10/2025. C·∫£m ∆°n b·∫°n ƒë√£ tin t∆∞·ªüng d·ªãch v·ª• c·ªßa ch√∫ng t√¥i.\",\n  \"includeRepairSummary\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/{{approved_claim_id}}/notify-customer",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "{{approved_claim_id}}", "notify-customer"]
            }
          },
          "response": []
        },
        {
          "name": "9.3 Kh√°ch h√†ng ƒë·∫øn l·∫•y xe - X√°c nh·∫≠n nh·∫≠n xe",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"VEHICLE_PICKED_UP\",\n  \"pickupDate\": \"2025-10-24T15:30:00\",\n  \"customerSatisfaction\": \"VERY_SATISFIED\",\n  \"customerFeedback\": \"D·ªãch v·ª• s·ª≠a ch·ªØa r·∫•t t·ªët. Xe ho·∫°t ƒë·ªông nh∆∞ m·ªõi. C·∫£m ∆°n SC ƒë√£ s·ª≠a ch·ªØa nhanh ch√≥ng v√† chuy√™n nghi·ªáp.\",\n  \"customerSignature\": \"Nguy·ªÖn VƒÉn A\",\n  \"pickupNotes\": \"Kh√°ch h√†ng ƒë√£ ki·ªÉm tra xe v√† h√†i l√≤ng v·ªõi k·∫øt qu·∫£ s·ª≠a ch·ªØa. ƒê√£ k√Ω x√°c nh·∫≠n nh·∫≠n xe.\",\n  \"finalMileage\": 15050\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/{{approved_claim_id}}/handover-vehicle",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "{{approved_claim_id}}", "handover-vehicle"]
            }
          },
          "response": []
        },
        {
          "name": "9.4 Ho√†n th√†nh claim - ƒê√≥ng case",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"CLOSED\",\n  \"closureReason\": \"SUCCESSFUL_REPAIR\",\n  \"closureNotes\": \"Claim ƒë√£ ho√†n th√†nh th√†nh c√¥ng. Kh√°ch h√†ng ƒë√£ nh·∫≠n xe v√† h√†i l√≤ng v·ªõi d·ªãch v·ª•. Case ƒë∆∞·ª£c ƒë√≥ng.\",\n  \"closureDate\": \"2025-10-24T16:00:00\",\n  \"totalRepairTime\": \"4.5 hours\",\n  \"customerSatisfactionScore\": 5\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/{{approved_claim_id}}/close",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "{{approved_claim_id}}", "close"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "10. Reports & Analytics",
      "item": [
        {
          "name": "10.1 Xem b√°o c√°o t·ªïng h·ª£p claim - COMMENTED OUT",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/claims/{{approved_claim_id}}/summary",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "{{approved_claim_id}}", "summary"]
            }
          },
          "response": []
        },
        {
          "name": "10.2 Xem chi ti·∫øt Work Order ho√†n th√†nh",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/work-orders/{{work_order_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "work-orders", "{{work_order_id}}"]
            }
          },
          "response": []
        },
        {
          "name": "10.3 B√°o c√°o hi·ªáu su·∫•t technician - COMMENTED OUT",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/technicians/4/performance?startDate=2025-10-01&endDate=2025-10-31",
              "host": ["{{base_url}}"],
              "path": ["api", "technicians", "4", "performance"]
            }
          },
          "response": []
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080",
      "type": "string"
    },
    {
      "key": "access_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "technician_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "claim_id",
      "value": "1",
      "type": "string"
    },
    {
      "key": "draft_claim_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "technician_id",
      "value": "4",
      "type": "string"
    },
    {
      "key": "evm_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "evm_pending_claim_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "approved_claim_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "work_order_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "technician2_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "technician2_user",
      "value": "",
      "type": "string"
    },
    {
      "key": "technician2_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "assigned_claim_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "assigned_technician_id",
      "value": "",
      "type": "string"
    }
  ]
}
