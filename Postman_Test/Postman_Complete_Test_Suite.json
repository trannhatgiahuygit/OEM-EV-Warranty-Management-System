{
  "info": {
    "name": "Complete EV Warranty Management Test Suite",
    "description": "B·ªô test ho√†n ch·ªânh cho h·ªá th·ªëng qu·∫£n l√Ω b·∫£o h√†nh xe ƒëi·ªán - T·ª± ƒë·ªông ƒëƒÉng nh·∫≠p v√† test t·∫•t c·∫£ ch·ª©c nƒÉng",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080",
      "type": "string"
    },
    {
      "key": "admin_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "evm_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "sc_staff_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "technician_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "test_claim_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "test_work_order_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "test_customer_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "test_vehicle_id",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "üîê Authentication Tests",
      "item": [
        {
          "name": "1. Admin Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Admin login successful\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    var token = jsonData.token || jsonData.accessToken;",
                  "    pm.collectionVariables.set(\"admin_token\", token);",
                  "    console.log(\"‚úÖ Admin Token saved\");",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"admin_user\",\n  \"password\": \"123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/login",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "login"]
            }
          }
        },
        {
          "name": "2. EVM Staff Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"EVM Staff login successful\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    var token = jsonData.token || jsonData.accessToken;",
                  "    pm.collectionVariables.set(\"evm_token\", token);",
                  "    console.log(\"‚úÖ EVM Staff Token saved\");",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"evm_staff1\",\n  \"password\": \"123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/login",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "login"]
            }
          }
        },
        {
          "name": "3. SC Staff Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"SC Staff login successful\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    var token = jsonData.token || jsonData.accessToken;",
                  "    pm.collectionVariables.set(\"sc_staff_token\", token);",
                  "    console.log(\"‚úÖ SC Staff Token saved\");",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"sc_staff1\",\n  \"password\": \"123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/login",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "login"]
            }
          }
        },
        {
          "name": "4. SC Technician Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"SC Technician login successful\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    var token = jsonData.token || jsonData.accessToken;",
                  "    pm.collectionVariables.set(\"technician_token\", token);",
                  "    console.log(\"‚úÖ SC Technician Token saved\");",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"tech1\",\n  \"password\": \"123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/login",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "login"]
            }
          }
        }
      ]
    },
    {
      "name": "üë• Customer & Vehicle Management",
      "item": [
        {
          "name": "1. Create New Customer",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Customer created successfully\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set(\"test_customer_id\", jsonData.id);",
                  "    console.log(\"‚úÖ Test Customer ID: \" + jsonData.id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{sc_staff_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Test Customer Auto\",\n  \"email\": \"testcustomer@example.com\",\n  \"phone\": \"0901234567\",\n  \"address\": \"123 Test Street, Test City\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/customers",
              "host": ["{{base_url}}"],
              "path": ["api", "customers"]
            }
          }
        },
        {
          "name": "2. Register New Vehicle",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Vehicle registered successfully\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set(\"test_vehicle_id\", jsonData.id);",
                  "    console.log(\"‚úÖ Test Vehicle ID: \" + jsonData.id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{sc_staff_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"vin\": \"TESTVIN123456789\",\n  \"licensePlate\": \"TEST-001\",\n  \"model\": \"Test EV Model\",\n  \"year\": 2024,\n  \"customerId\": {{test_customer_id}},\n  \"registrationDate\": \"2024-01-01\",\n  \"warrantyStart\": \"2024-01-01\",\n  \"warrantyEnd\": \"2027-01-01\",\n  \"mileageKm\": 0\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/vehicles",
              "host": ["{{base_url}}"],
              "path": ["api", "vehicles"]
            }
          }
        },
        {
          "name": "3. Check Vehicle Warranty Status",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Check warranty status successful\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Warranty status present\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.isInWarranty).to.exist;",
                  "    pm.expect(jsonData.warrantyStart).to.exist;",
                  "    pm.expect(jsonData.warrantyEnd).to.exist;",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{sc_staff_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/vehicles/{{test_vehicle_id}}/warranty-status",
              "host": ["{{base_url}}"],
              "path": ["api", "vehicles", "{{test_vehicle_id}}", "warranty-status"]
            }
          }
        }
      ]
    },
    {
      "name": "üîß Warranty Claim Flow",
      "item": [
        {
          "name": "1. Create Warranty Claim",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Claim created successfully\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set(\"test_claim_id\", jsonData.id);",
                  "    console.log(\"‚úÖ Test Claim ID: \" + jsonData.id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{sc_staff_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"vin\": \"TESTVIN123456789\",\n  \"customerName\": \"Test Customer Auto\",\n  \"customerEmail\": \"testcustomer@example.com\",\n  \"customerPhone\": \"0901234567\",\n  \"customerAddress\": \"123 Test Street, Test City\",\n  \"reportedFailure\": \"Battery not charging properly, shows error code B001\",\n  \"initialDiagnosis\": \"Potential battery management system failure\",\n  \"mileageKm\": 1000,\n  \"flow\": \"draft\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/intake",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "intake"]
            }
          }
        },
        {
          "name": "2. Update Claim Diagnostic",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Diagnostic updated successfully\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Diagnostic details updated\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.diagnosticDetails).to.exist;",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{sc_staff_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"claimId\": {{test_claim_id}},\n  \"diagnosticDetails\": \"Battery management system diagnostic completed. Found faulty temperature sensor in battery pack #2. Requires replacement of sensor and recalibration.\",\n  \"estimatedRepairCost\": 250.00,\n  \"estimatedRepairTime\": \"2-3 hours\",\n  \"requiredParts\": [\n    {\n      \"partId\": 6,\n      \"partName\": \"Battery Temperature Sensor\",\n      \"quantity\": 1\n    }\n  ],\n  \"diagnosticImages\": [\n    \"/uploads/diagnostics/sensor_fault.jpg\",\n    \"/uploads/diagnostics/battery_pack_2.jpg\"\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/diagnostic",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "diagnostic"]
            }
          }
        },
        {
          "name": "3. Mark Claim Ready for Submission",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Claim marked ready for submission\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Status updated to PENDING_EVM_APPROVAL\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.status).to.include(\"PENDING_EVM_APPROVAL\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{sc_staff_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"claimId\": {{test_claim_id}}\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/{{test_claim_id}}/ready-for-submission",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "{{test_claim_id}}", "ready-for-submission"]
            }
          }
        },
        {
          "name": "4. EVM Approve Claim",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Claim approved successfully\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Status updated to EVM_APPROVED\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.status).to.include(\"EVM_APPROVED\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{evm_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"warrantyCost\": 250.00,\n  \"companyPaidCost\": 250.00,\n  \"approvalNotes\": \"Battery temperature sensor replacement approved. Standard warranty repair.\",\n  \"estimatedRepairTime\": \"2-3 hours\",\n  \"priority\": \"NORMAL\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/evm/claims/{{test_claim_id}}/approve",
              "host": ["{{base_url}}"],
              "path": ["api", "evm", "claims", "{{test_claim_id}}", "approve"]
            }
          }
        }
      ]
    },
    {
      "name": "üî® Work Order Management",
      "item": [
        {
          "name": "1. Create Work Order",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Work order created successfully\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set(\"test_work_order_id\", jsonData.id);",
                  "    console.log(\"‚úÖ Test Work Order ID: \" + jsonData.id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{sc_staff_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"claimId\": {{test_claim_id}},\n  \"technicianId\": 4,\n  \"estimatedLaborHours\": 2.5,\n  \"startTime\": \"2024-01-20T08:00:00\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/work-orders/create",
              "host": ["{{base_url}}"],
              "path": ["api", "work-orders", "create"]
            }
          }
        },
        {
          "name": "2. Reserve Parts for Work Order",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Parts reserved successfully\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Reserved parts list present\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{sc_staff_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"workOrderId\": {{test_work_order_id}},\n  \"items\": [\n    {\n      \"partId\": 6,\n      \"quantity\": 1\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/inventory/reserve",
              "host": ["{{base_url}}"],
              "path": ["api", "inventory", "reserve"]
            }
          }
        },
        {
          "name": "3. Update Work Order Progress",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Work order updated successfully\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Work order details updated\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.result).to.exist;",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{technician_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"result\": \"Battery temperature sensor replaced successfully. All systems tested and functioning normally.\",\n  \"laborHours\": 2.5,\n  \"partsUsed\": [\n    {\n      \"partId\": 6,\n      \"partName\": \"Battery Temperature Sensor\",\n      \"quantity\": 1,\n      \"serialNumber\": \"SENS001-2024-001\"\n    }\n  ],\n  \"notes\": \"Sensor replacement completed. Battery pack #2 temperature readings now normal.\",\n  \"images\": [\n    \"/uploads/repairs/sensor_installed.jpg\",\n    \"/uploads/repairs/calibration_complete.jpg\"\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/work-orders/{{test_work_order_id}}/update",
              "host": ["{{base_url}}"],
              "path": ["api", "work-orders", "{{test_work_order_id}}", "update"]
            }
          }
        },
        {
          "name": "4. Complete Work Order",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Work order completed successfully\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Work order marked as completed\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.endTime).to.exist;",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{technician_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}"
            },
            "url": {
              "raw": "{{base_url}}/api/work-orders/{{test_work_order_id}}/complete",
              "host": ["{{base_url}}"],
              "path": ["api", "work-orders", "{{test_work_order_id}}", "complete"]
            }
          }
        }
      ]
    },
    {
      "name": "üìä Reporting & Analytics",
      "item": [
        {
          "name": "1. Generate Warranty Cost Report",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Generate warranty cost report successful\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Report data present\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.executiveSummary).to.exist;",
                  "    pm.expect(jsonData.periodBreakdown).to.exist;",
                  "    pm.expect(jsonData.categoryBreakdown).to.exist;",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{evm_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reportType\": \"COMPREHENSIVE\",\n  \"reportStartDate\": \"2024-01-01\",\n  \"reportEndDate\": \"2024-12-31\",\n  \"groupBy\": \"MONTHLY\",\n  \"includePreviousPeriod\": true,\n  \"filters\": {\n    \"status\": [\"EVM_APPROVED\", \"COMPLETED\", \"CLOSED\"],\n    \"vehicleModels\": [\"Test EV Model\"],\n    \"costRange\": {\n      \"min\": 0,\n      \"max\": 10000\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/evm/warranty-cost-report",
              "host": ["{{base_url}}"],
              "path": ["api", "evm", "warranty-cost-report"]
            }
          }
        },
        {
          "name": "2. Get Dashboard Summary",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Get dashboard summary successful\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Dashboard data present\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.totalClaims).to.exist;",
                  "    pm.expect(jsonData.pendingApprovals).to.exist;",
                  "    pm.expect(jsonData.totalCost).to.exist;",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{evm_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/evm/dashboard/summary",
              "host": ["{{base_url}}"],
              "path": ["api", "evm", "dashboard", "summary"]
            }
          }
        }
      ]
    },
    {
      "name": "üì¶ Inventory Management",
      "item": [
        {
          "name": "1. Get Current Stock Levels",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Get stock levels successful\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Stock data present\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.content || jsonData).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{evm_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/inventory/stock?page=0&size=20",
              "host": ["{{base_url}}"],
              "path": ["api", "inventory", "stock"],
              "query": [
                {
                  "key": "page",
                  "value": "0"
                },
                {
                  "key": "size",
                  "value": "20"
                }
              ]
            }
          }
        },
        {
          "name": "2. Get Low Stock Alerts",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Get low stock alerts successful\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Low stock alerts data present\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{evm_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/inventory/low-stock",
              "host": ["{{base_url}}"],
              "path": ["api", "inventory", "low-stock"]
            }
          }
        }
      ]
    },
    {
      "name": "üö® Recall Campaign Management",
      "item": [
        {
          "name": "1. Create Recall Campaign",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Recall campaign created successfully\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set(\"test_campaign_id\", jsonData.id);",
                  "    console.log(\"‚úÖ Test Campaign ID: \" + jsonData.id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{evm_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"code\": \"RC-2024-TEST\",\n  \"title\": \"Test Battery Management System Update\",\n  \"description\": \"Software update for battery management system to prevent overheating in test conditions\",\n  \"status\": \"draft\",\n  \"releasedAt\": null,\n  \"createdBy\": \"evm_staff1\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/recall-campaigns",
              "host": ["{{base_url}}"],
              "path": ["api", "recall-campaigns"]
            }
          }
        },
        {
          "name": "2. Release Campaign",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Release campaign successful\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Campaign released\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.status).to.eql(\"active\");",
                  "    pm.expect(jsonData.releasedAt).to.exist;",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{evm_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/recall-campaigns/{{test_campaign_id}}/release",
              "host": ["{{base_url}}"],
              "path": ["api", "recall-campaigns", "{{test_campaign_id}}", "release"]
            }
          }
        }
      ]
    },
    {
      "name": "‚úÖ Complete Repair Flow",
      "item": [
        {
          "name": "1. Complete Repair",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Repair completed successfully\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Claim status updated to REPAIR_COMPLETED\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.status).to.include(\"REPAIR_COMPLETED\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{technician_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"repairSummary\": \"Battery temperature sensor replaced. All systems tested and functioning normally.\",\n  \"partsReplaced\": [\n    {\n      \"partId\": 6,\n      \"partName\": \"Battery Temperature Sensor\",\n      \"quantity\": 1,\n      \"serialNumber\": \"SENS001-2024-001\"\n    }\n  ],\n  \"laborHours\": 2.5,\n  \"finalCost\": 250.00,\n  \"qualityCheckPassed\": true,\n  \"testResults\": \"All temperature sensors reading normal. Battery pack functioning correctly.\",\n  \"images\": [\n    \"/uploads/repairs/final_test_results.jpg\"\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/{{test_claim_id}}/complete-repair",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "{{test_claim_id}}", "complete-repair"]
            }
          }
        },
        {
          "name": "2. Perform Final Inspection",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Final inspection completed successfully\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Claim status updated to READY_FOR_HANDOVER\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.status).to.include(\"READY_FOR_HANDOVER\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{technician_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"inspectionResults\": \"All systems functioning correctly. Temperature sensors calibrated. Vehicle ready for customer pickup.\",\n  \"qualityChecks\": [\n    \"Battery temperature monitoring - PASS\",\n    \"Charging system - PASS\",\n    \"Motor operation - PASS\",\n    \"Safety systems - PASS\"\n  ],\n  \"inspectorName\": \"Bob Wilson\",\n  \"inspectionDate\": \"2024-01-20T15:30:00\",\n  \"notes\": \"Repair completed successfully. All quality checks passed.\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/{{test_claim_id}}/final-inspection",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "{{test_claim_id}}", "final-inspection"]
            }
          }
        },
        {
          "name": "3. Handover Vehicle to Customer",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Vehicle handover completed successfully\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Claim status updated to COMPLETED\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.status).to.include(\"COMPLETED\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{sc_staff_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"handoverDate\": \"2024-01-20T16:00:00\",\n  \"customerSatisfaction\": \"Satisfied\",\n  \"customerSignature\": \"Test Customer Auto\",\n  \"mileageAtHandover\": 1000,\n  \"notes\": \"Customer informed about repair details. Warranty documentation provided.\",\n  \"documentsProvided\": [\n    \"Warranty repair certificate\",\n    \"Service history update\",\n    \"Quality inspection report\"\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/{{test_claim_id}}/handover",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "{{test_claim_id}}", "handover"]
            }
          }
        },
        {
          "name": "4. Close Claim",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Claim closed successfully\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Claim status updated to CLOSED\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.status).to.include(\"CLOSED\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{sc_staff_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"closureReason\": \"Repair completed successfully and vehicle handed over to customer\",\n  \"finalNotes\": \"Battery temperature sensor replacement completed. Customer satisfied with service.\",\n  \"totalCost\": 250.00,\n  \"warrantyCoverage\": \"Full warranty coverage applied\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/claims/{{test_claim_id}}/close",
              "host": ["{{base_url}}"],
              "path": ["api", "claims", "{{test_claim_id}}", "close"]
            }
          }
        }
      ]
    }
  ]
}
